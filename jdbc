import java.sql.*;
public class QueryJDBC {

	public static void main(String[] args) throws Exception
	{
		Class.forName("oracle.jdbc.driver.OracleDriver");
		Connection connection=DriverManager.getConnection("jdbc:oracle:thin:@135.250.220.98:1521:HCLDSDB","HCL_DBUSER","test_user");
		System.out.println("connection established");
		Statement statement=connection.createStatement();
		//price range
		PriceSelect priceselect=new PriceSelect(connection,statement);
		priceselect.selectprice();
		//update shippng status
		UpdateShippingStatus shippingStatus=new UpdateShippingStatus(connection,statement);
		shippingStatus.update();
		
//		add to cart
		AddCart addCart=new AddCart(connection, statement);
		addCart.cart();
//		manufacture feedback
		ManufacturerFeedback manufacturer=new ManufacturerFeedback(connection, statement);
		manufacturer.feedback();
		
		//manufacture filtering
		manufacture_filter filter=new manufacture_filter(connection, statement);
		filter.manufacturer();	
		//shipping status
		getshippingstatus shipping=new getshippingstatus(connection, statement);    
		shipping.shippingstatus();			
		
		System.out.println("closing connection");
		statement.close();
		connection.close();
	}

}
class PriceSelect
{
	Connection connections;
	Statement statement;
	public PriceSelect(Connection connections, Statement statement) {
		this.connections=connections;
		this.statement=statement;
	}

	void selectprice() throws SQLException
	{
		
		String q1="select price from Hcl_Sk_Item where price between 6000 and 15000";
		ResultSet resultset=statement.executeQuery(q1);
		while(resultset.next())
		{
			System.out.println(resultset.getInt("price"));
		}
		System.out.println("select price done");
		resultset.close();
	}
}

class UpdateShippingStatus
{
	Connection connection;
	Statement statement;
	UpdateShippingStatus(Connection connection, Statement statement) {
		this.connection=connection;
		this.statement=statement;
	}
	public void update() throws SQLException {
		String q1="update Hcl_Sk_Shipping_Order set Shipping_Status='d' where id in(select id from Hcl_Sk_Shipping_Order where mod(id,2)=0)";
		String q2="update Hcl_Sk_Shipping_Order set delivered_date=sysdate where shipping_status='d'";
		statement.executeUpdate(q1);
		statement.executeUpdate(q2);
		System.out.println("Update Shipping Status Completed Successfully");
	}
}


class AddCart
{
	Connection connection;
	Statement statement;
	public AddCart(Connection connections, Statement statement) {
		this.connection=connections;
		this.statement=statement;
	}

	void cart() throws SQLException
	{
		
		String q1="INSERT  INTO HCL_SK_ORDER(ITEM_ID,ID,ORDER_DATE,QUANTITY,USER_ACCOUNT_ID,PAYMENT) VALUES(127,203,SYSDATE,1,2,0)";
		statement.executeUpdate(q1);
		System.out.println("INSERTION IS DONE");
		
	}
}
class ManufacturerFeedback
{
	Connection connection;
	Statement statement;
	ManufacturerFeedback(Connection connection, Statement statement) {
		this.connection=connection;
		this.statement=statement;
	}
	public void feedback() throws SQLException {
		String q1="UPDATE HCL_SK_MANUFACTURER SET RATING=0 WHERE NAME='Huawei'";
	    statement.executeUpdate(q1);//DONE
		System.out.println("RATING IS DONE");
	}
}
class manufacture_filter
{
	Connection connection;
	Statement statement;
	public manufacture_filter(Connection connections, Statement statement) 
	{
		this.connection=connections;
		this.statement=statement;
	}
   void manufacturer() throws SQLException
	{
		String q1= "SELECT item.NAME FROM HCL_SK_ITEM item JOIN HCL_SK_MANUFACTURER manufacture ON (item.MANUFACTURER_ID = manufacture.ID)";
		ResultSet resultSet=statement.executeQuery(q1);
		while(resultSet.next())
		{
			System.out.println(resultSet.getString("name"));
		}
		System.out.println("Filtering successful");		
	}
}
class getshippingstatus
{
	Connection connection;
	Statement statement;
	getshippingstatus(Connection connection, Statement statement) 
	{
		this.connection=connection;
		this.statement=statement;
	}
	public void shippingstatus() throws SQLException 
	{
		String q1="SELECT  SHIPPING_STATUS FROM HCL_SK_SHIPPING_ORDER WHERE order_id=10";
	    statement.executeUpdate(q1);
		System.out.println("shipping status is displayed");
	}
}
